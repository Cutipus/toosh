<div class="flex h-full flex-col">
  <section id="about-text" class="mt-3 flex flex-shrink-0 flex-grow basis-auto flex-col gap-4 pr-4">
    <p id="hi" class="blinking-cursor text-black-600 font-narkiss text-big blur-[0.04rem] contrast-200">
      Hey there!! I'm <b>Itamar</b>, a freelance <b>Graphic/Motion Designer</b> from TLV.
    </p>
    <p class="blinking-cursor text-black-600 font-narkiss text-big blur-[0.04rem] contrast-200">
      Currently in my 4th year of Visual Communication studies at Bezalel Academy JLM.
    </p>
    <p class="blinking-cursor text-black-600 font-narkiss text-big blur-[0.04rem] contrast-200">
      Mainly focusing on <b>Motion Design, Video making & Animation</b>, but enjoy making and co-making all sorts of art and
      design.
    </p>
  </section>

  <section id="contact-info">
    <p class="text-black-600 text-center font-narkiss text-[1.2em]/[1.7rem] blur-[0.04rem] contrast-200">
      If what you see turns you on...<br />
      Hit me up â¤µ
    </p>
  </section>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const elem = document.getElementById("about-text");
    const preservedInner = elem.innerHTML;
    elem.innerHTML = "";
    animate(elem, parseNode(preservedInner));
  });

  function parseNode(html) {
    const tempDiv = document.createElement("div");
    tempDiv.innerHTML = html;

    let out = document.createElement("p");
    return processChildNodes(tempDiv, out);
  }

  function* processChildNodes(tempy, out) {
    for (const node of tempy.childNodes) {
      if (node.nodeType === Node.TEXT_NODE) {
        for (const char of node.textContent) {
          out.append(char);
          yield out.innerHTML;
        }
      } else if (node.nodeType === Node.ELEMENT_NODE) {
        const newElement = document.createElement(node.tagName.toLowerCase());
        for (const { name, value } of node.attributes) {
          newElement.setAttribute(name, value);
        }
        out.appendChild(newElement);
        for (const processed of processChildNodes(node, newElement)) {
          yield out.innerHTML;
        }
      }
    }
  }

  function animate(elem, gen) {
    let lastTimestamp;

    function step(timestamp) {
      if (lastTimestamp == undefined) {
        lastTimestamp = timestamp;
      }
      const delta = lastTimestamp - timestamp;
      lastTimestamp = timestamp;
      res = gen.next();
      if (!res.done) {
        elem.innerHTML = res.value;
        requestAnimationFrame(step);
      }
    }

    requestAnimationFrame(step);
  }
</script>
